<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Processx FIFOs — conn_create_fifo • processx</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Processx FIFOs — conn_create_fifo"><meta name="description" content="
Create a FIFO for inter-process communication
Note that these functions are currently experimental."><meta property="og:description" content="
Create a FIFO for inter-process communication
Note that these functions are currently experimental."><meta name="robots" content="noindex"><script defer data-domain="processx.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">processx</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">3.8.6.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/internals.html">processx internals</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/processx/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Processx FIFOs</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/processx/blob/main/R/connections.R" class="external-link"><code>R/connections.R</code></a></small>
      <div class="d-none name"><code>processx_fifos.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>Create a FIFO for inter-process communication
Note that these functions are currently experimental.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">conn_create_fifo</span><span class="op">(</span></span>
<span>  filename <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  read <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  write <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  encoding <span class="op">=</span> <span class="st">""</span>,</span>
<span>  nonblocking <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">conn_connect_fifo</span><span class="op">(</span></span>
<span>  <span class="va">filename</span>,</span>
<span>  read <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  write <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  encoding <span class="op">=</span> <span class="st">""</span>,</span>
<span>  nonblocking <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-filename">filename<a class="anchor" aria-label="anchor" href="#arg-filename"></a></dt>
<dd><p>File name of the FIFO. On Windows it the name of the
pipe within the <code>\\?\pipe\</code> namespace, either the full name, or the
part after that prefix. If <code>NULL</code>, then a random name
is used, on Unix in the R temporary directory: <code><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">base::tempdir()</a></code>.</p></dd>


<dt id="arg-read">read<a class="anchor" aria-label="anchor" href="#arg-read"></a></dt>
<dd><p>If <code>TRUE</code> then connect to the read end of the FIFO.
Exactly one of <code>read</code> and <code>write</code> must be set to <code>TRUE</code>.</p></dd>


<dt id="arg-write">write<a class="anchor" aria-label="anchor" href="#arg-write"></a></dt>
<dd><p>If <code>TRUE</code> then connect to the write end of the FIFO.
Exactly one of <code>read</code> and <code>write</code> must be set to <code>TRUE</code>.</p></dd>


<dt id="arg-encoding">encoding<a class="anchor" aria-label="anchor" href="#arg-encoding"></a></dt>
<dd><p>Encoding to assume.</p></dd>


<dt id="arg-nonblocking">nonblocking<a class="anchor" aria-label="anchor" href="#arg-nonblocking"></a></dt>
<dd><p>Whether this should be a non-blocking FIFO.
Note that blocking FIFOs are not well tested and might not work well with
<code><a href="poll.html">poll()</a></code>, especially on Windows. We might remove this option in the
future and make all FIFOs non-blocking.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>conn_create_fifo()</code> creates a FIFO and connects to it.
On Unix this is a proper FIFO in the file system, in the R temporary
directory. On Windows it is a named pipe.</p>
<p>Use <code><a href="processx_connections.html">conn_file_name()</a></code> to query the name of the FIFO, and
<code>conn_connect_fifo()</code> to connect to the other end.</p>
<p><code>conn_connect_fifo()</code> connects to a FIFO created with
<code>conn_create_fifo()</code>, typically in another process. <code>filename</code> refers
to the name of the pipe on Windows.</p>
<p>On Windows, <code>conn_connect_fifo()</code> may be successful even if the
FIFO does not exist, but then later <code><a href="poll.html">poll()</a></code> or read/write operations
will fail. We are planning on changing this behavior in the future,
to make <code>conn_connect_fifo()</code> fail immediately, like on Unix.</p>
    </div>
    <div class="section level2">
    <h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a></h2>

<div class="section">
<h3 id="in-general-unix-domain-sockets-work-better-than-fifos-so-we-suggest">In general Unix domain sockets work better than FIFOs, so we suggest<a class="anchor" aria-label="anchor" href="#in-general-unix-domain-sockets-work-better-than-fifos-so-we-suggest"></a></h3>


<p>you use sockets if you can. See <code><a href="processx_sockets.html">conn_create_unix_socket()</a></code>.</p>
</div>

<div class="section">
<h3 id="creating-the-read-end-of-the-fifo">Creating the read end of the FIFO<a class="anchor" aria-label="anchor" href="#creating-the-read-end-of-the-fifo"></a></h3>


<p>This case is simpler. To wait for a writer to connect to the FIFO
you can use <code><a href="poll.html">poll()</a></code> as usual. Then use <code><a href="processx_connections.html">conn_read_chars()</a></code> or
<code><a href="processx_connections.html">conn_read_lines()</a></code> to read from the FIFO, as usual. Use
<code><a href="processx_connections.html">conn_is_incomplete()</a></code> <em>after</em> a read to check if there is more data,
or the writer is done.</p>
</div>

<div class="section">
<h3 id="creating-the-write-end-of-the-fifo">Creating the write end of the FIFO<a class="anchor" aria-label="anchor" href="#creating-the-write-end-of-the-fifo"></a></h3>


<p>This is somewhat trickier. Creating the (non-blocking) FIFO does not
block. However, there is no easy way to tell if a reader is connected
to the other end of the FIFO or not. On Unix you can start using
<code><a href="processx_connections.html">conn_write()</a></code> to try to write to it, and this will succeed, until the
buffer gets full, even if there is no reader. (When the buffer is full
it will return the data that was not written, as usual.)</p>
<p>On Windows, using <code><a href="processx_connections.html">conn_write()</a></code> to write to a FIFO without a reader
fails with an error. This is not great, we are planning to improve it
later.</p>
<p>Right now, one workaround for this behavior is for the reader to
connunicate to the writer process independenctly that it has connected
to the FIFO. (E.g. another FIFO in the opposite direction can do that.)</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://processx.r-lib.org/dev/articles/internals.html" class="external-link">processx internals</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example for a non-blocking FIFO</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Need to open the reading end first, otherwise Unix fails</span></span></span>
<span class="r-in"><span><span class="va">reader</span> <span class="op">&lt;-</span> <span class="fu">conn_create_fifo</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Always use poll() before you read, with a timeout if you like.</span></span></span>
<span class="r-in"><span><span class="co"># If you read before the other end of the FIFO is connected, then</span></span></span>
<span class="r-in"><span><span class="co"># the OS (or processx?) assumes that the FIFO is done, and you cannot</span></span></span>
<span class="r-in"><span><span class="co"># read anything.</span></span></span>
<span class="r-in"><span><span class="co"># Now poll() tells us that there is no data yet.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="poll.html">poll</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">reader</span><span class="op">)</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "timeout"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">writer</span> <span class="op">&lt;-</span> <span class="fu">conn_connect_fifo</span><span class="op">(</span><span class="fu"><a href="processx_connections.html">conn_file_name</a></span><span class="op">(</span><span class="va">reader</span><span class="op">)</span>, write <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="processx_connections.html">conn_write</a></span><span class="op">(</span><span class="va">writer</span>, <span class="st">"hello\nthere!\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="poll.html">poll</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">reader</span><span class="op">)</span>, <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ready"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="processx_connections.html">conn_read_lines</a></span><span class="op">(</span><span class="va">reader</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "hello"</span>
<span class="r-in"><span><span class="fu"><a href="processx_connections.html">conn_read_chars</a></span><span class="op">(</span><span class="va">reader</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "there!\n"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="processx_connections.html">conn_is_incomplete</a></span><span class="op">(</span><span class="va">reader</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">close</a></span><span class="op">(</span><span class="va">writer</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-in"><span><span class="fu"><a href="processx_connections.html">conn_read_chars</a></span><span class="op">(</span><span class="va">reader</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] ""</span>
<span class="r-in"><span><span class="fu"><a href="processx_connections.html">conn_is_incomplete</a></span><span class="op">(</span><span class="va">reader</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/connections.html" class="external-link">close</a></span><span class="op">(</span><span class="va">reader</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by Gábor Csárdi, Winston Chang, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>, Ascent Digital Services.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

  </div></footer></body></html>

